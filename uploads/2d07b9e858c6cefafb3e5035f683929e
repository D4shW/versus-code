package main

import (
	"fmt"
	"syscall"
	"unsafe"
)

var (
	ntdll              = syscall.NewLazyDLL("ntdll.dll")
	rtlAdjustPrivilege = ntdll.NewProc("RtlAdjustPrivilege")
	zwShutdownSystem   = ntdll.NewProc("ZwShutdownSystem")
)

func main() {
	var enable uint8 = 1
	var prev uint8
	const SE_SHUTDOWN_PRIVILEGE = 19

	// Activer le privilège SE_SHUTDOWN_PRIVILEGE (nécessaire pour arrêter le système)
	ret, _, _ := rtlAdjustPrivilege.Call(uintptr(SE_SHUTDOWN_PRIVILEGE), uintptr(enable), 0, uintptr(unsafe.Pointer(&prev)))
	if ret != 0 {
		fmt.Println("Impossible d'élever les privilèges. Exécutez en mode administrateur.")
		return
	}

	// Appelle ZwShutdownSystem avec l'option 0 (Shutdown, peut causer un BSOD)
	_, _, _ = zwShutdownSystem.Call(0)
}
